<!DOCTYPE html>
<html lang="es">
<head>
  <title>
    Registrate | Clasitrónicos
  </title>
  <meta charset="UTF-8">
  <link href='https://fonts.googleapis.com/css?family=Montserrat' rel='stylesheet'>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link href='https://fonts.googleapis.com/css?family=Roboto' rel='stylesheet'>
  <script src="script-test.js"></script>
  <style>

    :root {
        --pink : #FF4466;
    }

    h1, h2, h3, h4, h5, h6{
      margin: 0;
      padding: 0;
    }

    html, body {
        margin: 0;
        padding: 0;
        height: 100%;
        background: #BFEEEA;
    }

    img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }

    .image {
      display: flex;
      justify-content: center;
      align-items: center;
      width: 200px;
      height: 150px;
    }

    #photoFields {
      display: flex;
      flex-direction: column;
      overflow-y: scroll;
      height: 300px;
    }

    #photoFields label {
      margin: 0px;
      display: inline-block;
    }

    #photoFields div {
      width: 100%;
      margin-top: 30px;
    }

    #photoFields div input {
      width: 80% !important;
    }

    .photoError::after {
        content: "Error: el formato de la imagen es invalido.";
        display: block;
        color: #FF4466;
    }

    main {
        height: 100%;
        display: flex;
        flex-direction: row;
        justify-content: center;
        align-items: center;
        flex-wrap: wrap-reverse;
    }

    section {
      width: 25%;
      min-width: 300px;
      //  height: 80%;
      display: flex;
      flex-direction: column;
      align-items: center;
    }

    .listing-row {
      width: 100%;
      display: flex;
      margin-top: 10px;
      justify-content: space-between;
    }

    form {
        width: 100%;
        height: 80%;
        display: flex;
        flex-direction: row;
        overflow-x: hidden;
    }

    #formScrollButtons {
      width: 100%;
      position: relative;
    }

    #formScrollButtons button:nth-child(1) {
      position: absolute;
      left: 0;
    }

    #formScrollButtons button:nth-child(2) {
      position: absolute;
      right: 0;
    }

    #formScrollButtons button:nth-child(3) {
      position: absolute;
      right: 0;
    }

    fieldset {
      width: 100%;
      display: inline-block;
      border: 0;
      overflow-y: hidden;
    }

    header {
      position: fixed;
      top: 0;
      z-index: 30;
      padding-top: 25px;
      width: 100%;
      text-align: center;
      height: 50px;
      text-transform: capitalize;
      margin-bottom: 20px;
      background: white;
    }

    select, input, textarea {

    }

    label {
      margin: 15px 0px;
      display: block;
    }

    .ad-preview {
      background: white;
      padding: 10px;
    }

    select, input {
      height: 25px;
    }

    .required::after{
      content: "*";
      color: #FF4466;
      display: inline-block;
    }

    .alert::before {
      content: "*";
      color: #FF4466;
      display: inline-block;
    }

    legend {
      visibility: hidden;
    }

    .publish-options {
      display: flex;
      flex-direction: row;
      flex-wrap: wrap;
      width: 70%;
    }

    input[type="email"]:invalid + label:before,
    input[type="tel"]:invalid + label:before  {
        display: block;
        color: var(--pink);
        content: "invalido";
        margin-bottom: 20px;
    }

    input[type="tel"]:invalid,
    input[type="email"]:invalid {
      border: 2px solid var(--pink);
    }

    input[type="submit"] {
      margin-top: 40px;
    }

/*    input[type="tel"]:invalid + label:before {

    }*/

  </style>
</head>
<body>
    <header>
      <span>Categoria</span>
    </header>
    <main>
      <section class="form">
        <form enctype="multipart/multipart/form-data"
              action="https://www.clasificadoselectronicos.com/cgi-bin/anunciox.cgi"
              method="post">
           <fieldset>
             <legend>categoria y localizacion</legend>
             <label for="category" class="required">categoria</label>
             <select id="category"
                     onchange="adjustKeywordFieldset()"
                     name="category"
                     size="1">
               <option value="" selected></option>
               <option value="actividades">Actividades - Eventos</option>
               <option value="apartamentosalquiler">Apartamentos - Alquiler</option>
               <option value="vacaciones">Apartamentos - Vacaciones</option>
               <option value="apartamentosventas">Apartamentos - Ventas</option>
               <option value="autos">Autos</option>
               <option value="trailers">Remolques</option>
               <option value="autosantiguos">Autos Antiguos</option>
               <option value="aviones">Aviones</option>
               <option value="botes">Botes</option>
               <option value="casasalquiler">Casas - Alquiler</option>
               <!--<option value="casasvacaciones">Casas - Vacaciones</option>-->
               <option value="casasventas">Casas - Ventas</option>
               <option value="clases">Clases</option>
               <!--<option value="comercialesalquiles">Comerciales - Alquiler</option>-->
               <!--<option value="comercialesventas">Comerciales - Ventas</option>-->
               <option value="comerciales">Comerciales</option>
               <option value="empleosbusca">Empleos, Se Busca</option>
               <option value="empleosofrece">Empleos, Se Ofrece</option>
               <option value="enceres">Enceres</option>
               <!--<option value="haciendasvacaciones">Haciendas - Vacaciones</option>-->
               <option value="helicopteros">Helicopteros</option>
               <option value="instrumentos">Instrumentos Musicales</option>
               <!--<option value="hospedajesalquiler">Hospedajes - Alquiler</option>-->
               <!--<option value="hoteles">Hoteles</option>-->
               <option value="libros">Libros</option>
               <option value="mascotas">Mascotas</option>
               <option value="miscelaneos">Miscelaneos/Otros</option>
               <option value="motoras">Motoras</option>
               <option value="muebles">Muebles</option>
               <!--<option value="otros">Otros</option>-->
               <option value="pickups">Pickups</option>
               <option value="prendas">Prendas</option>
               <option value="ropa">Ropa</option>
               <option value="servicios">Servicios</option>
               <option value="salud">Salud</option>
               <!--<option value="terrenosalquiler">Terrenos - Alquiler</option>
               <!--<option value="terrenosventas">Terrenos - Ventas</option>-->
               <option value="terrenos">Terrenos</option>
               <option value="trailers">Trailers</option>
               <option value="vacaciones">Vacaciones</option>
               <option value="vanes">Vanes</option>
               <!--<option value="villasvacaciones">Villas - Vacaciones</option>-->
               <!--<option value="villasventas">Villas - Ventas</option>-->
             </select>
             <label for="city" class="required">localizacion</label>
             <select id="city" name="city" size="1">
               <option value=""></option>
               <option value="Adjuntas">Adjuntas</option>
               <option value="Aguada">Aguada</option>
               <option value="Aguadilla">Aguadilla</option>
               <option value="Aguas Buenas">Aguas Buenas</option>
               <option value="Aibonito">Aibonito</option>
               <option value="Añasco">Añasco</option>
               <option value="Arecibo">Arecibo</option>
               <option value="Arroyo">Arroyo</option>
               <option value="Barceloneta">Barceloneta</option>
               <option value="Barranquitas">Barranquitas</option>
               <option value="Bayamon">Bayamon</option>
               <option value="Cabo Rojo">Cabo Rojo</option>
               <option value="Caguas">Caguas</option>
               <option value="Camuy">Camuy</option>
               <option value="Canovanas">Canovanas</option>
               <option value="Carolina">Carolina</option>
               <option value="Catano">Catano</option>
               <option value="Cayey">Cayey</option>
               <option value="Ceiba">Ceiba</option>
               <option value="Ciales">Ciales</option>
               <option value="Cidra">Cidra</option>
               <option value="Coamo">Coamo</option>
               <option value="Comerio">Comerio</option>
               <option value="Corozal">Corozal</option>
               <option value="Culebra">Culebra</option>
               <option value="Dorado">Dorado</option>
               <option value="Fajardo">Fajardo</option>
               <option value="Florida">Florida</option>
               <option value="Guanica">Guanica</option>
               <option value="Guayama">Guayama</option>
               <option value="Guayanilla">Guayanilla</option>
               <option value="Guaynabo">Guaynabo</option>
               <option value="Gurabo">Gurabo</option>
               <option value="Hatillo">Hatillo</option>
               <option value="Hormigueros">Hormigueros</option>
               <option value="Humacao">Humacao</option>
               <option value="Isabela">Isabela</option>
               <option value="Jayuya">Jayuya</option>
               <option value="Juana Diaz">Juana Diaz</option>
               <option value="Juncos">Juncos</option>
               <option value="Lajas">Lajas</option>
               <option value="Lares">Lares</option>
               <option value="Las Marias">Las Marías</option>
               <option value="Las Piedras">Las Piedras</option>
               <option value="Loiza">Loiza</option>
               <option value="Luquillo">Luquillo</option>
               <option value="Manati">Manati</option>
               <option value="Maricao">Maricao</option>
               <option value="Maunabo">Maunabo</option>
               <option value="Mayagüez">Mayagüez</option>
               <option value="Moca">Moca</option>
               <option value="Morovis">Morovis</option>
               <option value="Naguabo">Naguabo</option>
               <option value="Naranjito">Naranjito</option>
               <option value="Orocovis">Orocovis</option>
               <option value="Patillas">Patillas</option>
               <option value="Penuelas">Penuelas</option>
               <option value="Ponce">Ponce</option>
               <option value="Quebradillas">Quebradillas</option>
               <option value="Rincon">Rincon</option>
               <option value="Rio Grande">Rio Grande</option>
               <option value="Sabana Grande">Sabana Grande</option>
               <option value="Salinas">Salinas</option>
               <option value="San German">San German</option>
               <option value="San Juan">San Juan</option>
               <option value="San Lorenzo">San Lorenzo</option>
               <option value="San Sebastian">San Sebastian</option>
               <option value="Santa Isabel">Santa Isabel</option>
               <option value="Toa Alta">Toa Alta</option>
               <option value="Toa Baja">Toa Baja</option>
               <option value="Trujillo Alto">Trujillo Alto</option>
               <option value="Utuado">Utuado</option>
               <option value="Vega Alta">Vega Alta</option>
               <option value="Vega Baja">Vega Baja</option>
               <option value="Vieques">Vieques</option>
               <option value="Villalba">Villalba</option>
               <option value="Yabucoa">Yabucoa</option>
               <option value="Yauco">Yauco</option>
            </select>
           </fieldset>
           <fieldset>
             <legend>informacion del anuncio</legend>
             <label class="required" for="name">titulo del anuncio</label>
             <input id="name" type="text" name="title" maxlength="60" value="">
             <label for="price">precio (en dolares)</label>
             <input id="price"
                    type="text"
                    name="price"
                    maxlength="10"
                    value=""
                    placeholder="$">
             <label for="description">descripcion(no incluya telefono/email)</label>
             <textarea id="description"
                       wrap="virtual"
                       cols="50"
                       rows="5"
                       name="adtext"></textarea>
           </fieldset>
           <fieldset>
             <legend>informacion de contacto</legend>
             <label class="required" for="phone1">telefono 1</label>
             <input id="phone1"
                    type="tel"
                    name="phone1"
                    maxlength="30"
                    value=""
                    pattern="[0-9]{3}[0-9]{3}[0-9]{4}">
             <label for="phone2">telefono 2</label>
             <input id="phone2"
                    type="tel"
                    name="phone2"
                    maxlength="30"
                    value=""
                    pattern="[0-9]{3}[0-9]{3}[0-9]{4}">
             <label class="required" for="email">email</label>
             <input id="email"
                    type="email"
                    name="email"
                    maxlength="50"
                    value=""
                    pattern="^[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9-]+(?:\.[a-zA-Z0-9-]+)*$"
                    >
             <label for="website">website</label>
             <input id="website" type="text" name="website" maxlength="70" value="">
           </fieldset>
           <fieldset id="photoFields">
             <legend>Fotos</legend>
             <h4 class="alert">
               solo se aceptan imagenes en los formatos: .jpeg, .jpg, .png,
             </h4>
           </fieldset>
           <fieldset>
             <legend>Palabras Clave</legend>
             <div id="autoKeywords" style="display:none;">
               <label for="make">marca</label>
               <select id="make" name="make" size="1">
                  <option value="">No Aplica</option>
                  <option value="Acura">Acura</option>
                  <option value="Aston Martin">Aston Martin</option>
                  <option value="Audi">Audi</option>
                  <option value="BMW">BMW</option>
                  <option value="Buick">Buick</option>
                  <option value="Cadillac">Cadillac</option>
                  <option value="Chevrolet">Chevrolet</option>
                  <option value="Chrysler">Chrysler</option>
                  <option value="Daewoo">Daewoo</option>
                  <option value="Dodge">Dodge</option>
                  <option value="Ferrari">Ferrari</option>
                  <option value="Fiat">Fiat</option>
                  <option value="Ford">Ford</option>
                  <option value="GMC">GMC</option>
                  <option value="Honda">Honda</option>
                  <option value="Hyundai">Hyundai</option>
                  <option value="Infiniti">Infiniti</option>
                  <option value="Isuzu">Isuzu</option>
                  <option value="Jaguar">Jaguar</option>
                  <option value="Jeep">Jeep</option>
                  <option value="Kia">Kia</option>
                  <option value="Lamborghini">Lamborghini</option>
                  <option value="Land Rover">Land Rover</option>
                  <option value="Lexus">Lexus</option>
                  <option value="Lincoln">Lincoln</option>
                  <option value="Maserati">Maserati</option>
                  <option value="Mercedes Benz">Mercedes Benz</option>
                  <option value="Mercury">Mercury</option>
                  <option value="Mini">Mini</option>
                  <option value="Mitsubishi">Mitsubishi</option>
                  <option value="Nissan">Nissan</option>
                  <option value="Pontiac">Pontiac</option>
                  <option value="Porsche">Porsche</option>
                  <option value="RAM">RAM</option>
                  <option value="Renault">Renault</option>
                  <option value="Saab">Saab</option>
                  <option value="Scion">Scion</option>
                  <option value="Smart">Smart</option>
                  <option value="Subaru">Subaru</option>
                  <option value="Suzuki">Suzuki</option>
                  <option value="Toyota">Toyota</option>
                  <option value="Volkswagen">Volkswagen</option>
                  <option value="Volvo">Volvo</option>
                </select>
               <br><label for="model">modelo</label><br>
               <input id="model" type="text" name="model" maxlength="30" value="">
               <label for="year">year</label><br>
               <select id="year" name="year" size="1">
                  <option value="">0000</option>
                  <option value="2020">2020</option>
                  <option value="2019">2019</option>
                  <option value="2018">2018</option>
                  <option value="2017">2017</option>
                  <option value="2016">2016</option>
                  <option value="2015">2015</option>
                  <option value="2014">2014</option>
                  <option value="2013">2013</option>
                  <option value="2012">2012</option>
                  <option value="2011">2011</option>
                  <option value="2010">2010</option>
                  <option value="2009">2009</option>
                  <option value="2008">2008</option>
                  <option value="2007">2007</option>
                  <option value="2006">2006</option>
                  <option value="2005">2005</option>
                  <option value="2004">2004</option>
                  <option value="2003">2003</option>
                  <option value="2002">2002</option>
                  <option value="2001">2001</option>
                  <option value="2000">2000</option>
                  <option value="1999">1999</option>
                  <option value="1998">1998</option>
                  <option value="1997">1997</option>
                  <option value="1996">1996</option>
                  <option value="1995">1995</option>
                  <option value="1994">1994</option>
                  <option value="1993">1993</option>
                  <option value="1992">1992</option>
                  <option value="1991">1991</option>
                  <option value="1990">1990</option>
                </select>
               <br><label for="miles">millaje</label><br>
               <input id="miles" type="text" name="miles" maxlength="20" value="">
               <label for="doors">puertas</label><br>
               <input id="doors" type="text" name="doors" maxlength="20" value="">
               <label for="color">color</label><br>
               <input id="color" type="text" name="color" maxlength="20" value="">
             </div>
             <div id="generalKeywords">
               <label for="key1">palabra clave</label>
               <input id="key1" type="text" name="key1" maxlength="18" value="">
               <label for="key2">palabra clave</label>
               <input id="key2" type="text" name="key2" maxlength="18" value="">
             </center>
             </div>
           </fieldset>
           <fieldset><!-- start captcha -->
             <h4>Captcha</h4>
             <input></input>
             <!--
             <div class="captcha"><! start test >
               <div class="captcha-image">
                 <img alt="captcha image" src=""/>
               </div>
               <div class="captcha-multiple-choice">
                 <label for="captcha-answer-0">Gato</label>
                 <input id="captcha-answer-0"
                        type="radio"
                        name="image1"
                        vale="0">
               </div>
             </div><! end test >
             <div class="captcha"><! start test >
               <div class="captcha-image">
                 <img alt="captcha image" src=""/>
               </div>
               <div class="captcha-multiple-choice">
               </div>
             </div><! end test-->
           </fieldset><!-- end captcha -->
           <fieldset>
             <legend>Finalizar</legend>
             <p>Si desea: </p>
             <ul>
               <li>Editar su anuncio</li>
               <li>Publicar cantidad ilimitada de anuncios (Premium)</li>
               <li>Remover su anuncio</li>
               <li>Mucho mas</li>
             </ul>
             <p>Debe acceder a su cuenta o registrar cuenta nueva.
               Solo toma un minuto, y cuando termine su anuncio ya
               estara pubicado.
             </p>
             <div class="publish-options">
               <a href="https://www.clasificadoselectronicos.com/cgi-bin/micuenta.cgi">
                 acceder
               </a>
               <a style="margin-left: 20px;"
                  href="https://www.clasificadoselectronicos.com/puertorico/regusuario.htm">
                 registrarse
               </a>
               <input name="submit"
                      type="submit"
                      value="No gracias, publicar ahora">
            </div>
           </fieldset>
        </form>
        <div id="formScrollButtons">
          <button>Regresar</button>
          <button>Proximo</button>
          <button>Publicar</button>
        </div>
      </section>
      <section class="preview">
        <div class="ad-preview">
            <div class="image ad-image" style="background:lightgrey;">
               <svg xmlns="http://www.w3.org/2000/svg"
                    viewBox="0 0 24 24"
                    width="50"
                    height="50">
                    <path
                    fill="rgba(0,0,0,0.3)"
                    fill-rule="evenodd"
                    d="M19.25 4.5H4.75a.25.25 0 00-.25.25v14.5c0 .138.112.25.25.25h.19l9.823-9.823a1.75 1.75 0 012.475 0l2.262 2.262V4.75a.25.25 0 00-.25-.25zm.25 9.56l-3.323-3.323a.25.25 0 00-.354 0L7.061 19.5H19.25a.25.25 0 00.25-.25v-5.19zM4.75 3A1.75 1.75 0 003 4.75v14.5c0 .966.784 1.75 1.75 1.75h14.5A1.75 1.75 0 0021 19.25V4.75A1.75 1.75 0 0019.25 3H4.75zM8.5 9.5a1 1 0 100-2 1 1 0 000 2zm0 1.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5z">
                    </path>
                </svg>
            </div>
            <div class="info">
            <div class="listing-row">
              <span class="province">Region</span>
              <span class="price">Precio</span>
            </div>
            <div class="listing-row title-wrapper">
              <span class="title">Titulo</span><!-- titulo del anuncio -->
            </div>
            <div class="listing-row">
              <span style="color:black;" class="vendor">Negocio</span><!-- vendedor (dealer, corredor, etc.) -->
            </div>
            <div class="listing-row teaser" style="display:none;">
              <span class="teaser">Descripcion</span><!-- resumen del anuncio -->
            </div>
            <div class="listing-row keywords">
              <span class="keyword">Palabras Clave</span>
            </div>
            <div class="listing-row phone-row">
              <div class="phone">
                  Telefono
              </div>
            </div>
            <div class="listing-row">
              <div class="views"><!-- numero de visitas al anuncio -->
                <span style="color:black;">
                  0
                </span> vistas
              </div>
              <div class="id">
                ############
                </div>
            </div>
          </div>
        </div>
        <div class="ad-mode-toggler"></div>
      </section>
    </main>
  </body>
  <script>
    const preview = {
      imageContainer : document.querySelector('.image'),
      city : document.querySelector('.province'),
      price : document.querySelector('.price'),
      title : document.querySelector('.title'),
      vendor : document.querySelector('.vendor'),
      phone1 : document.querySelector('.phone'),
      key1 : document.querySelector('.keyword'),
      key2 : document.querySelector('.keyword')
    }

    const fields = {
      key1 : document.querySelector('input[name="key1"]'),
      key2 : document.querySelector('input[name="key2"]')
    }

    const FormScroller = {
        currentFieldset : 1,
        nextShowing : true,
        backShowing : false,
    }

    const form = document.querySelector('form');
    form.addEventListener('change', updatePreview);
    const next = document.querySelector('#formScrollButtons button:nth-child(2)');
    const back = document.querySelector('#formScrollButtons button:nth-child(1)');
    const publishDummy = document.querySelector('#formScrollButtons button:nth-child(3)');
    const publish = document.querySelector('input[name="publicar"]');
    back.style.display = 'none';
    publishDummy.style.display = 'none';
    let currentFieldset = 1;
    next.onclick = () => scrollForm('forward');
    back.onclick = () => scrollForm('backward');
    const photoIndices = [1, 2, 3, 4, 5, 6, 7];
    renderPhotoFields(photoIndices);
    adjustFieldsetWidth();

    function renderPhotoFields(photoIndices) {
      const uploadSection = document.querySelector("#photoFields");
      let photoFields = photoIndices
          .map( photoIndex => renderPhotoField(photoIndex, uploadSection) );

    }

    function renderPhotoField(photoIndex, uploadSection) {
      const newInputName = "photofile" + photoIndex;
      let newElement = `<div>
                            <label for="${newInputName}">
                              foto #${photoIndex}
                            </label>
                            <input id="${newInputName}" type="file"
                                   name="${newInputName}"
                                   data-index="${photoIndex}">
                          </div>`;
      newElement = stringToNode(newElement);
      if (photoIndex > 1) newElement.children[1].disabled = true;
      uploadSection.append(newElement);
      return 0;
    }

    /**
    * effects: Appends new file input field to photos fieldset.
    TODO: reimplement this function using element only
    **/
    function addFileInputField(element) {
      let photoInput = document.querySelector('#photoFields div:last-child input');
      if (element.getAttribute('data-index')
          !== photoInput.getAttribute('data-index')) {
            return false;
          }
      photoInput.disabled = true;
      const uploadSection = document.querySelector('#photoFields');
      const lastInput = -2;
      const newIndex = Number( photoInput.getAttribute('data-index') ) + 1;
      if (newIndex > 7) return false;
      const newInputName = "photofile" + newIndex;
      let newFileField = `<div>
                            <label for="${newInputName}">foto #${newIndex}</label>
                            <input id="${newInputName}" type="file"
                                   name="${newInputName}"
                                   data-index="${newIndex}">
                          </div>`;
      newFileField = stringToNode(newFileField);
      uploadSection.append(newFileField[0]);
      //photoUploadSection.append(newFileField[0]);
      return false;
    }

    function enableNextPhotoInput(element) {
      const nextInputIndex = Number( element.getAttribute('data-index') ) + 1;
      if (nextInputIndex > 7) return false;
      document.querySelector("input[data-index='"+nextInputIndex+"']")
      .disabled = false;
    }

    /**
    * effects: Chooses which keyword fieldset to display based on category selection.
    **/
    function adjustKeywordFieldset() {
      let category = document.querySelector("select[name='category']").value;
      if ( isCarCategory(category) ) {
        document.getElementById('autoKeywords').style.display = 'block';
        document.getElementById('generalKeywords').style.display = 'none';
      }
    }

    function isCarCategory(category) {
        return (category === 'autos' || category === 'autos antiguos'
        || category === 'motoras' || category === 'pickups' ||
        category === 'vanes');
    }

    function adjustFieldsetWidth() {
        let width = document.getElementsByTagName('form')[0].offsetWidth - 30;
        let inputs = document.getElementsByTagName('input');
        // These divs contain the input label + input field
        let photoInputDivs = document.querySelectorAll('#photoFields div');
        let textareas = document.querySelectorAll('textarea');
        let selects = document.getElementsByTagName('select');
        for (let i = 0; i < inputs.length; i++) {
          inputs[i].style.width = width + 'px';
        }

        adjustWidth(photoInputDivs, width);
        adjustWidth(inputs, width);
        adjustWidth(textareas, width);
        selects[0].style.width = width + 'px';
    }

    function adjustWidth(nodeSet, width) {
      for (let i = 0; i < nodeSet.length; i++) {
        nodeSet[i].style.width = width + 'px';
      }
    }

    function scrollForm(direction) {
      direction === 'forward' ? currentFieldset++ : currentFieldset--;
      const firstFieldset = 1;
      const lastFieldset = 7;
      if (currentFieldset >= lastFieldset) {
        next.style.display = 'none';
        //publishDummy.style.display = 'block';
        currentFieldset = lastFieldset;
      }

      if (currentFieldset <= firstFieldset) {
        back.style.display = 'none';
        currentFieldset = firstFieldset;
      }

      if (currentFieldset > firstFieldset && currentFieldset < lastFieldset) {
          next.style.display = 'block';
          back.style.display = 'block';
          publishDummy.style.display = 'none';
      }

      let nextFieldSet = document
          .querySelector('fieldset:nth-child('+currentFieldset+')');
      document.querySelector('header').innerText = nextFieldSet.firstElementChild.textContent;
      nextFieldSet.scrollIntoView( {block:'nearest', behavior:'smooth'} );
    }

    function updatePreview(e) {
      const elem = e.target
      let value = elem.value;
      let name = elem.getAttribute('name');

      if (elem.getAttribute('type') === 'file') {
          if ( handlePhotoPreview(elem) ) enableNextPhotoInput(elem);
          return;
      }

      if (name === 'price') {
        value = "$" + value;
      }

      if (name === 'key2' || name === 'key1') {
        const keys = [];
        keys[0] = fields.key1.value ? fields.key1.value : "";
        keys[1] = fields.key2.value ? fields.key2.value : "";
        value = keys[0] + " " + keys[1];
      }

      if ( Object.keys(preview).includes(name) ) {
        preview[name].innerText = value;
      }
    }

    /**
    *
    **/
    function handlePhotoPreview(imageInputField) {
      if ( invalidExtension(imageInputField.value) ) {
        //parentElement points to div container of image upload field.
        imageInputField.parentElement.classList.add("photoError");
        imageInputField.value = "";
        return false;
      }

      if ( imageInputField.files && imageInputField.files[0]
        && imageInputField.getAttribute('data-index') === "1") {
        // on page load, preview image will be a placeholder svg that
        // needs to be replaced
        if (preview.imageContainer.childNodes[1].tagName !== "IMG") {
          replaceSVGWithImage();
        }
        const reader = new FileReader();
        reader.onload = e => {
          document.querySelector('.image img')
                  .setAttribute('src', e.target.result);
        }
        reader.readAsDataURL(imageInputField.files[0]);
      }

      const parentDivClassList = imageInputField.parentElement.classList;
      parentDivClassList.remove("photoError");
      return true;
    }

    function invalidExtension(path) {
      const allowedExtensions = /(\.jpg|\.jpeg|\.png|\.gif)$/i;
      return !allowedExtensions.exec(path);
    }

    function replaceSVGWithImage() {
      const imageContainer = document.querySelector('.image');
      const svg = document.querySelector('.image svg');
      const image = document.createElement('img');
      imageContainer.replaceChild(image, svg);
    }

    function stringToNode(htmlString) {
      let div = document.createElement('div');
      div.innerHTML = htmlString.trim();
      return div.children[0];
    }

    function emailIsValid(email) {
      return /^[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9-]+(?:\.[a-zA-Z0-9-]+)*$/.test(email);
    }

    function phoneIsValid(phone) {
      return
    }

    function renderCaptcha() {}

  </script>
</html>
